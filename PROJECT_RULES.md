# å‰ç«¯é¡¹ç›®å¼€å‘è§„èŒƒ

> **ğŸ“Œ æœ¬æ–‡æ¡£æ˜¯å‰ç«¯é¡¹ç›®çš„ç‰¹å®šè§„èŒƒ**  
> å…¬å…±è§„åˆ™è¯·å‚è€ƒï¼š`../.rules/project_rules.md`  
> æœ¬æ–‡æ¡£ä»…åŒ…å«å‰ç«¯ï¼ˆReact + TypeScript + Viteï¼‰ç‰¹å®šçš„å¼€å‘è§„èŒƒ

## æŠ€æœ¯æ ˆ

- **React**: 19.2.0 - UI æ¡†æ¶
- **TypeScript**: 5.7.2 - ç±»å‹ç³»ç»Ÿ
- **Vite**: 6.1.0 - æ„å»ºå·¥å…·
- **Ant Design**: 6.0.0 - UI ç»„ä»¶åº“
- **React Router DOM**: 7.9.6 - è·¯ç”±ç®¡ç†
- **Axios**: 1.13.2 - HTTP å®¢æˆ·ç«¯

## ç›®å½•è§„èŒƒ

```
src/
â”œâ”€â”€ common                     # å…¨å±€å…¬å…±é…ç½®ç›®å½•
â”‚   â””â”€â”€ api/                   # API æ¥å£å®šä¹‰ç›®å½•
â”‚       â”œâ”€â”€ userApi.ts         # ç”¨æˆ·ç›¸å…³ API
â”‚       â””â”€â”€ index.ts           # API ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ pages                      # é¡¹ç›®é¡µé¢ç›®å½•
â”‚   â”œâ”€â”€ home/                  # é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ Home.tsx
â”‚   â”‚   â””â”€â”€ Home.css
â”‚   â”œâ”€â”€ login/                 # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â””â”€â”€ Login.css
â”‚   â”œâ”€â”€ main/                  # ä¸»å¸ƒå±€é¡µ
â”‚   â”‚   â”œâ”€â”€ main.tsx
â”‚   â”‚   â””â”€â”€ main.css
â”‚   â””â”€â”€ userCenter/            # ç”¨æˆ·ä¸­å¿ƒ
â”‚       â”œâ”€â”€ UserManagement.tsx
â”‚       â”œâ”€â”€ UserAdd.tsx
â”‚       â””â”€â”€ UserDetail.tsx
â””â”€â”€ widget                     # ç»„ä»¶ç›®å½•
    â”œâ”€â”€ api                    # APIæ¥å£ç›®å½•
    â”œâ”€â”€ libs                   # Libåº“ç®¡ç†ç›®å½•
    â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
    â”‚   â”‚   â”œâ”€â”€ format.ts      # æ ¼å¼åŒ–å·¥å…·
    â”‚   â”‚   â””â”€â”€ validate.ts    # éªŒè¯å·¥å…·
    â”‚   â”œâ”€â”€ types/             # ç±»å‹å®šä¹‰
    â”‚   â”‚   â”œâ”€â”€ user.ts        # ç”¨æˆ·ç±»å‹
    â”‚   â”‚   â””â”€â”€ api.ts         # API ç±»å‹
    â”‚   â””â”€â”€ hooks/             # è‡ªå®šä¹‰é’©å­
    â”‚       â”œâ”€â”€ useAuth.ts     # è®¤è¯é’©å­
    â”‚       â””â”€â”€ useApi.ts      # API è°ƒç”¨é’©å­
    â”œâ”€â”€ router                 # è·¯ç”±ç›®å½•
    â”‚   â”œâ”€â”€ route/             # è·¯ç”±å®ä¾‹åŒ–é€»è¾‘
    â”‚   â”‚   â”œâ”€â”€ appRouter.tsx
    â”‚   â”‚   â””â”€â”€ sideRouter.tsx
    â”‚   â”œâ”€â”€ index.tsx          # è·¯ç”±é…ç½®
    â”‚   â”œâ”€â”€ router.tsx        # åº”ç”¨è·¯ç”±
    â”‚   â””â”€â”€ types.ts          # è·¯ç”±æ˜ å°„ç±»å‹
    â”œâ”€â”€ buss                   # ä¸šåŠ¡ç»„ä»¶
    â”‚   â”œâ”€â”€ auth/              # è®¤è¯ç›¸å…³ç»„ä»¶
    â”‚   â”‚   â”œâ”€â”€ AuthGuard.tsx
    â”‚   â”‚   â””â”€â”€ LoginGuard.tsx
    â”‚   â””â”€â”€ userManager/       # ç”¨æˆ·ç®¡ç†ç»„ä»¶
    â”‚       â”œâ”€â”€ UserTable.tsx
    â”‚       â””â”€â”€ UserForm.tsx
    â””â”€â”€ ui                     # UIç»„ä»¶ç›®å½•
        â”œâ”€â”€ PageContainer/     # é¡µé¢å®¹å™¨ç»„ä»¶
        â”‚   â”œâ”€â”€ PageContainer.tsx
        â”‚   â””â”€â”€ PageContainer.css
        â”œâ”€â”€ Button/            # æŒ‰é’®ç»„ä»¶
        â”‚   â”œâ”€â”€ Button.tsx
        â”‚   â””â”€â”€ Button.css
        â””â”€â”€ Table/             # è¡¨æ ¼ç»„ä»¶
            â”œâ”€â”€ Table.tsx
            â””â”€â”€ Table.css
```

## å‰ç«¯ç‰¹å®šè§„èŒƒ

### 1. ç»„ä»¶ï¼ˆWidgetï¼‰å¼ºåˆ¶è§„èŒƒ

Widget ç›®å½•å¼ºåˆ¶åˆ†ä¸ºï¼š
- **ä¸šåŠ¡ç»„ä»¶ï¼ˆbussï¼‰**ï¼šåŒ…å«ä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶
- **UIç»„ä»¶ï¼ˆuiï¼‰**ï¼šçº¯å±•ç¤ºæ€§ç»„ä»¶
- **Libåº“ç®¡ç†ç›®å½•ï¼ˆlibsï¼‰**ï¼šå·¥å…·å‡½æ•°ã€ç±»å‹å®šä¹‰ã€Hooks
- **è·¯ç”±ç›®å½•ï¼ˆrouterï¼‰**ï¼šè·¯ç”±é…ç½®å’Œç®¡ç†

ç»„ä»¶æ–‡ä»¶å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œé‡‡ç”¨é©¼å³°å‘½åæ³•ã€‚

å½“åŒä¸€ä¸ªé€»è¾‘æˆ–UIåœ¨å¤šä¸ªé¡µé¢é‡å¤ä½¿ç”¨æ—¶ï¼Œåº”å°†å…¶å®šä¹‰ä¸ºä¸šåŠ¡ç»„ä»¶æˆ–UIç»„ä»¶ï¼Œé¿å…é‡å¤ç¼–å†™ä»£ç ã€‚

### 2. React ç»„ä»¶è§„èŒƒ

#### 2.1 ç»„ä»¶å®šä¹‰

- ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ï¼Œä¼˜å…ˆä½¿ç”¨ `React.FC` ç±»å‹
- ç»„ä»¶åå¿…é¡»ä½¿ç”¨å¤§é©¼å³°å‘½åæ³•ï¼ˆPascalCaseï¼‰
- ç»„ä»¶æ–‡ä»¶å¿…é¡»ä¸ç»„ä»¶åä¿æŒä¸€è‡´

#### 2.2 Props å®šä¹‰

- ä½¿ç”¨ `interface` å®šä¹‰ç»„ä»¶ Props ç±»å‹
- Props æ¥å£å‘½åæ ¼å¼ï¼š`ç»„ä»¶åProps`ï¼Œå¦‚ `UserProfileProps`
- å¿…é¡»ä¸ºæ‰€æœ‰ Props æ·»åŠ ç±»å‹æ³¨è§£

#### 2.3 Hooks ä½¿ç”¨

- ä¼˜å…ˆä½¿ç”¨å‡½æ•°å¼ç»„ä»¶å’Œ Hooks
- è‡ªå®šä¹‰ Hooks å¿…é¡»ä»¥ `use` å¼€å¤´ï¼Œæ”¾åœ¨ `widget/libs/hooks` ç›®å½•
- é¿å…åœ¨å¾ªç¯ã€æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨ Hooks
- ä½¿ç”¨ `useMemo` å’Œ `useCallback` ä¼˜åŒ–æ€§èƒ½ï¼Œä½†é¿å…è¿‡åº¦ä¼˜åŒ–

#### 2.4 çŠ¶æ€ç®¡ç†

- ç®€å•çŠ¶æ€ä½¿ç”¨ `useState`
- å¤æ‚çŠ¶æ€ä½¿ç”¨ `useReducer`
- å…¨å±€çŠ¶æ€è€ƒè™‘ä½¿ç”¨ Context API æˆ–çŠ¶æ€ç®¡ç†åº“

### 3. è·¯ç”±è§„èŒƒ

#### 3.1 è·¯ç”±å®šä¹‰

- è·¯ç”±ã€è·³è½¬è·¯å¾„å¿…é¡»ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œé‡‡ç”¨é©¼å³°å‘½åæ³•
- è·¯ç”±è·¯å¾„å¿…é¡»ä¸ `Page` æ–‡ä»¶è·¯å¾„å’Œåç§°ä¸€è‡´
- ç¤ºä¾‹ï¼š`/userProfile` å¯¹åº” `pages/userProfile/UserProfile.tsx`

#### 3.2 è·¯ç”±è·³è½¬

- **å¼ºåˆ¶è¦æ±‚**ï¼šè·³è½¬è·¯å¾„å¿…é¡»ä» `routerMap` å®šä¹‰ä¸­è·å–ï¼Œç¦æ­¢ä¹¦å†™ç¡¬ç¼–ç 
- æ­£ç¡®ç¤ºä¾‹ï¼š`routerMap.userCenter.children?.userAdd`
- é”™è¯¯ç¤ºä¾‹ï¼š`'/userCenter/userAdd'`ï¼ˆç¡¬ç¼–ç ï¼‰

#### 3.3 è·¯ç”±é…ç½®

- è·¯ç”±é…ç½®ç»Ÿä¸€åœ¨ `widget/router/index.tsx` ä¸­ç®¡ç†
- ä½¿ç”¨ `React.lazy` å®ç°è·¯ç”±æ‡’åŠ è½½
- è·¯ç”±æ˜ å°„ç±»å‹å®šä¹‰åœ¨ `widget/router/types.ts`

### 4. API è°ƒç”¨è§„èŒƒ

#### 4.1 API å®šä¹‰

- API æ¥å£ç»Ÿä¸€åœ¨ `common/api` ç›®å½•ä¸‹å®šä¹‰
- ä½¿ç”¨ `axios` è¿›è¡Œ HTTP è¯·æ±‚
- å¿…é¡»å®šä¹‰è¯·æ±‚å’Œå“åº”çš„ç±»å‹

#### 4.2 é”™è¯¯å¤„ç†

- ç»Ÿä¸€å¤„ç† API é”™è¯¯
- ä½¿ç”¨ try-catch æ•è·å¼‚æ­¥é”™è¯¯
- é”™è¯¯ä¿¡æ¯å¿…é¡»å‹å¥½æç¤ºç”¨æˆ·

#### 4.3 è¯·æ±‚æ‹¦æˆª

- ç»Ÿä¸€åœ¨ axios æ‹¦æˆªå™¨ä¸­å¤„ç† tokenã€é”™è¯¯ç ç­‰
- è¯·æ±‚å’Œå“åº”æ‹¦æˆªå™¨ç»Ÿä¸€é…ç½®

### 5. æ–‡ä»¶å‘½åè§„èŒƒ

| ç±»å‹ | å‘½åè§„åˆ™ | ç¤ºä¾‹ |
|------|----------|------|
| ç›®å½•å‘½å | `pages`ã€`widget` ç›®å½•åç§°å¿…é¡»ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œé‡‡ç”¨é©¼å³°å‘½åæ³• | `userProfile` |
| æ–‡ä»¶å‘½å - Page/UIç»„ä»¶ | `pages` å’Œ `widget` ç›®å½•ä¸‹çš„ `Page` å’Œ `UIç»„ä»¶` æ–‡ä»¶ä½¿ç”¨å¤§å†™å­—æ¯é©¼å³°å‘½å | `UserProfile.tsx` |
| æ–‡ä»¶å‘½å - CSS | `Page` å’Œ `UIç»„ä»¶` ä¾èµ–çš„ `css` æ–‡ä»¶éœ€ä¿æŒä¸€è‡´å‘½å | `UserProfile.css` |
| æ–‡ä»¶å‘½å - å·¥å…·æ–‡ä»¶ | `lib`ã€`hooks`ã€`types`ã€`utils` ç›®å½•ä¸‹çš„æ–‡ä»¶ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œé‡‡ç”¨é©¼å³°åˆ¶ | `useUserProfile.ts` |
| å˜é‡å‘½å | ä¸šåŠ¡ä»£ç å˜é‡åå…¨éƒ¨å¿…é¡»ä½¿ç”¨é©¼å³°å‘½åæ³• | `userName` |
| è·¯ç”±å®šä¹‰ | è·¯ç”±ã€è·³è½¬è·¯å¾„å¿…é¡»ä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œé‡‡ç”¨é©¼å³°å‘½åæ³• | `/userProfile` |
| CSSç±»å‘½å | éµå¾ª sassã€less è§„èŒƒï¼Œç±»å‘½åä½¿ç”¨é©¼å³°å‘½åæ³• | `.userProfile` |

### 6. TypeScript ä½¿ç”¨è§„èŒƒï¼ˆå‰ç«¯ç‰¹å®šï¼‰

1. **ç±»å‹å®šä¹‰ä½ç½®**ï¼š
   - ç±»å‹å®šä¹‰ç»Ÿä¸€æ”¾åœ¨ `widget/libs/types` ç›®å½•ä¸‹
   - æŒ‰æ¨¡å—ç»„ç»‡ç±»å‹æ–‡ä»¶ï¼Œå¦‚ `user.ts`ã€`api.ts`

2. **ç±»å‹å¯¼å…¥**ï¼š
   - ä½¿ç”¨ `import type` å¯¼å…¥ç±»å‹
   - ç¤ºä¾‹ï¼š`import type { UserInfo } from '@widget/libs/types/user'`

### 7. æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

#### 7.1 ä»£ç åˆ†å‰²

- ä½¿ç”¨ `React.lazy` å’Œ `Suspense` å®ç°è·¯ç”±æ‡’åŠ è½½
- å¤§å‹ç»„ä»¶è€ƒè™‘ä»£ç åˆ†å‰²

#### 7.2 æ¸²æŸ“ä¼˜åŒ–

- é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
- ä½¿ç”¨ `React.memo` ä¼˜åŒ–ç»„ä»¶æ¸²æŸ“
- åˆç†ä½¿ç”¨ `useMemo` å’Œ `useCallback`

#### 7.3 èµ„æºä¼˜åŒ–

- å›¾ç‰‡ä½¿ç”¨åˆé€‚çš„æ ¼å¼å’Œå°ºå¯¸
- ä½¿ç”¨ CDN åŠ è½½é™æ€èµ„æº
- åˆç†ä½¿ç”¨ç¼“å­˜ç­–ç•¥

### 8. é”™è¯¯å¤„ç†è§„èŒƒ

#### 8.1 é”™è¯¯è¾¹ç•Œ

- ä½¿ç”¨ Error Boundary æ•è·ç»„ä»¶é”™è¯¯
- æä¾›å‹å¥½çš„é”™è¯¯æç¤ºé¡µé¢

#### 8.2 é”™è¯¯æ—¥å¿—

- é‡è¦é”™è¯¯éœ€è¦è®°å½•æ—¥å¿—
- å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
- ç”Ÿäº§ç¯å¢ƒéšè—æ•æ„Ÿä¿¡æ¯

## å¼€å‘æµç¨‹

### åˆ›å»ºæ–°é¡µé¢

1. åœ¨ `pages` ç›®å½•ä¸‹åˆ›å»ºé¡µé¢ç›®å½•ï¼ˆå°å†™é©¼å³°å‘½åï¼‰
2. åˆ›å»ºé¡µé¢ç»„ä»¶æ–‡ä»¶ï¼ˆå¤§é©¼å³°å‘½åï¼Œå¦‚ `UserProfile.tsx`ï¼‰
3. åˆ›å»ºå¯¹åº”çš„ CSS æ–‡ä»¶ï¼ˆä¸ç»„ä»¶åŒåï¼‰
4. åœ¨ `widget/router/index.tsx` ä¸­é…ç½®è·¯ç”±
5. åœ¨ `widget/router/router.tsx` ä¸­æ·»åŠ è·¯ç”±æ˜ å°„

### åˆ›å»ºæ–°ç»„ä»¶

1. **ä¸šåŠ¡ç»„ä»¶**ï¼šåœ¨ `widget/buss` ç›®å½•ä¸‹åˆ›å»º
2. **UI ç»„ä»¶**ï¼šåœ¨ `widget/ui` ç›®å½•ä¸‹åˆ›å»º
3. ç»„ä»¶æ–‡ä»¶ä½¿ç”¨å¤§é©¼å³°å‘½å
4. å¿…é¡»å®šä¹‰ Props ç±»å‹æ¥å£
5. å¿…é¡»æ·»åŠ å®Œæ•´çš„æ³¨é‡Šï¼ˆå‚è€ƒå…¬å…±è§„åˆ™ï¼‰

### åˆ›å»ºå·¥å…·å‡½æ•°

1. åœ¨ `widget/libs/utils` ç›®å½•ä¸‹åˆ›å»ºå·¥å…·æ–‡ä»¶
2. æ–‡ä»¶ä½¿ç”¨å°å†™é©¼å³°å‘½å
3. å¿…é¡»å®šä¹‰å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ç±»å‹
4. å¿…é¡»æ·»åŠ å®Œæ•´çš„æ³¨é‡Šå’Œä½¿ç”¨ç¤ºä¾‹

## ä»£ç ç¤ºä¾‹

### ç»„ä»¶ç¤ºä¾‹

```typescript
/**
 * @name UserProfile
 * @description ç”¨æˆ·èµ„æ–™ç»„ä»¶ï¼Œå±•ç¤ºç”¨æˆ·åŸºæœ¬ä¿¡æ¯
 * @author AI
 * @date 2025-01-15
 */

import React from 'react';
import type { UserInfo } from '@widget/libs/types/user';

interface UserProfileProps {
  user: UserInfo;
  onEdit?: (user: UserInfo) => void;
}

const UserProfile: React.FC<UserProfileProps> = ({ user, onEdit }) => {
  return (
    <div className="userProfile">
      {/* ç»„ä»¶å†…å®¹ */}
    </div>
  );
};

export default UserProfile;
```

### API è°ƒç”¨ç¤ºä¾‹

```typescript
/**
 * @name getUserInfo
 * @description è·å–ç”¨æˆ·ä¿¡æ¯
 * @param userId ç”¨æˆ·ID
 * @returns ç”¨æˆ·ä¿¡æ¯
 */
export const getUserInfo = async (userId: number): Promise<UserInfo> => {
  const response = await axios.get(`/api/user/${userId}`);
  return response.data;
};
```

### è·¯ç”±è·³è½¬ç¤ºä¾‹

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ routerMap
import { routerMap } from '@widget/router';
navigate(routerMap.userCenter.children?.userAdd.path);

// âŒ é”™è¯¯ï¼šç¡¬ç¼–ç è·¯å¾„
navigate('/userCenter/userAdd');
```

## æ³¨æ„äº‹é¡¹

1. **è·¯ç”±è·³è½¬**ï¼šå¿…é¡»ä½¿ç”¨ `routerMap` ä¸­å®šä¹‰çš„è·¯ç”±ï¼Œç¦æ­¢ç¡¬ç¼–ç è·¯å¾„
2. **ç±»å‹å®‰å…¨**ï¼šé¿å…ä½¿ç”¨ `any`ï¼Œå……åˆ†åˆ©ç”¨ TypeScript ç±»å‹ç³»ç»Ÿ
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²
4. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰å¼‚æ­¥æ“ä½œå¿…é¡»å¤„ç†é”™è¯¯æƒ…å†µ
5. **ä»£ç å¤ç”¨**ï¼šç›¸åŒé€»è¾‘æˆ– UI å¿…é¡»æŠ½å–ä¸ºç»„ä»¶æˆ–å·¥å…·å‡½æ•°
6. **ç»„ä»¶æ‹†åˆ†**ï¼šéµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œä¿æŒç»„ä»¶ç®€æ´

---

**æ›´å¤šå…¬å…±è§„èŒƒè¯·å‚è€ƒï¼š`../.rules/project_rules.md`**
